# Дипломный проект по курсу «Django: создание функциональных веб-приложений»

Проект представляет собой API для интернет магазина.

## Начало работы.

1. Укажите свои настройки базы данных в api/settings.py в строке DATABASE.
2. Выполните миграцию с помощью команды manage.py migrate.
3. Загрузите в базу тестовые данные с помощью команды manage.py loaddata fixtures.json.
4. Токены можно получить через окно администратора http://127.0.0.1:8000/admin/

**Также в тестовых данных был создан пользователь-администратор. username: admin, password: admin.**

## Тестирование.

1. Файл requests.http содержит примеры запросов.
2. Команда pytest прогонит заготовленые тесты.

## Список методов.

##### Адрес API-Сервиса http://127.0.0.1:8000/api/v1/
Токен необходимо указывать в заголовках. **Authorization: Token _my_token_**
### Products
##### GET
* _/products/_  
    Возвращает список продуктов. Доступно неавторизованным пользователям.
    Фильтрация:

    - _/?name=_ По содержимому из названия
    - _/?description=_ По содержимому из описания
    - _/?min_price=_ От минимальной цены
    - _/?max_price=_ До максимальной цены
    
* _/products/id/_  
    Возвращает продукт с указанным id. Доступно неавторизованным пользователям.

##### POST
* _/products/_  
    Создает продукт. Доступно только администраторам.
    Пример тела запроса:    
        `{    
        "name": "Шоколадка",    
        "description": "Супер-пупер шокохруст!",    
        "price": "100.00"   
        }`
    - Поле **price** не может быть меньше 0. N > 0
        
##### PATCH
* _/products/id/_   
    Частичное изменение продукта. Доступно только администраторам.
    Пример тела запроса:
    `{        
        "description": "NEW_DESCRIPTION",    
        "price": "1"   
        }`
##### DELETE
* _/products/id/_   
    Удаляет продукт. Доступно только администраторам.
    
### Product-reviews
##### GET
* _/product-reviews/_  
    Возвращает список отзывов. Доступно только авторизованным пользователям.
    Фильтрация:

    - _/?author_id=_ По ID пользователя
    - _/?product_id=_ По ID продукта
    - _/?created_date=_ По дате создания
    
* _/product-reviews/id/_  
    Возвращает отзыв с указанным id. Доступно только авторизованным пользователям.

##### POST
* _/product-reviews/_  
    Создает отзыв. Доступно только авторизованным пользователям.
    Пример тела запроса:    
     `{
          "product_id": 1,
          "text": "ТЕСТ!",
          "rating": 5
           }`   
     - Поле **rating** может быть только в диапазоне 1 <= N <= 5.     
     - Один пользователь может создавать только один отзыв к продукту.

##### PATCH
* _/product-reviews/id/_   
    Частичное изменение отзыва. Доступно авторам отзыва и администрам.
    Пример тела запроса:
    `{        
        "text": "NEW_text",    
        "rating": "1"   
        }`
##### DELETE
* _/product-reviews/id/_   
    Удаляет отзыв. Доступно авторам отзыва и администрам.
    
### Orders
##### GET
* _/orders/_  
    Возвращает список заказов пользователя. Для администраторов возвращает список всех заказов. Доступно только авторизованным пользователям.   
    Фильтрация:

    - _/?status=_ По статусу заказа
    - _/?created_date=_ По дате создания
    - _/?updated_date=_ По дате обновления
    - _/?product=_ По продуктам из позиций
    - _/?amount=_ По общей сумме
    - _/?amount_from=_ От минимальной суммы
    - _/?amount_to=_ До максимальной суммы
    
* _/orders/id/_  
    Для администратора возвращает заказ с указанным id. Для авторизованного пользователя возвращает заказ если он является владельцем. Доступно только авторизованным пользователям.

##### POST
* _/orders/_  
    Создает заказ. Доступно только авторизованным пользователям.
    Пример тела запроса:    
     `{
    "positions": [
        {
            "product_id": 1,
            "quantity": 1
        },
        {
            "product_id": 2,
            "quantity": 1
        }
    ]
    }`   
     - Поле **quantity** может быть только больше 0. N > 0     
     - В заказе должна быть хотябы одна позиция.

##### PATCH
* _/orders/id/_   
    Частичное изменение заказа. Доступно только администрам.
    Пример тела запроса:
    `{        
        "status": "DONE" 
        }`
    - Поле **status** может быть только NEW / IN_PROGRESS / DONE
    
##### DELETE
* _/orders/id/_   
    Удаляет заказ. Доступно только администрам.
 
 ### Product-collections
##### GET
* _/product-collections/_  
    Возвращает список заказов подборок. Доступно только авторизованным пользователям.   
* _/product-collections/id/_  
    Возвращает подборку с указанным id. Доступно только авторизованным пользователям.

##### POST
* _/product-collections/_  
    Создает подборку. Доступно только администраторам.
    Пример тела запроса:    
     `{
        "title": "Тест",
        "positions": [
            {
                "product_id": 1,
                "quantity": 1
            }
        ],
        "text": "ТЕСТ!"
}`   
     - Поле **quantity** может быть только больше 0. N > 0     
     - В подборке должна быть хотябы одна позиция.

##### PATCH
* _/product-collections/id/_   
    Частичное изменение подборки. Доступно только администрам.
    Пример тела запроса:
    `{
        "title": "NEW_TEXT",
        "positions": [
        {
            "product_id": 1,
            "quantity": 1
        },
        {
            "product_id": 2,
            "quantity": 1
            }
        ],
        "text": "NEW_TEXT!"
}`   
    
##### DELETE
* _/product-collections/id/_   
    Удаляет подборку. Доступно только администрам.
 
 